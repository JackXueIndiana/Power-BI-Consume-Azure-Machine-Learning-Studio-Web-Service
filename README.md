# Power-BI-Consume-Azure-Machine-Learning-Studio-Web-Service
This article is to show you from Power BI Desktop how to call a web service created based a linear regression model in Azure Machine Studio to score a number of the rows in one call.

We started from reading this blog: http://radacad.com/power-bi-and-azure-ml-make-them-work-with-power-query. Though we installed R package AzureML, we still cannot get the code work. Looking at the web service generated by Azure Machine Learning Studio, we notice the sample code is using two standard R packages and a standard way to connect to the web service with kay and end point, therefore, we try to make this work in a different way then the blog. Here is what we did:

The input data is the Lemonade dataset with 365 rows and the following columns:
Date  from 2015-01-01 to 2015-12-31
Day from Monday to Sunday, late we convert it to 1-7, thus an integer
Temperature in Fahrenheit degree, thus a double
Rainfall in inch, thus a double
Number flyers distributed, thus an integer
Price in dollar, thus a double
Number of lemonade sales, an integer

We want to create a linear regression model to predict the sales based on day, temperature, rainfall, flyers, and price. Then we deployed this model as a web service.

To call this web service from other application, Power BI desktop in our case, we collect the following info from the web service: 
-	API key
-	Request/response end point
-	R sample code

We installed Microsoft R Open 3.5.1 on a PC, and installed two packages needed by the R script with the command in R console:
install.packages(“RCurl”)
install.packages(“rjson”)

After start he Power BI Desktop, from “Get Data” we load a local file Lemonade.csv. Then we create a query with R script (see the lemondade.R in the repo). After first run (by clicking the OK button in R scripting window in Power BI Query, we can see the “output” with a new column named PredictSales.

After saving everything, we update the file Lemonade.csv by adding a few more rows, and then click “Refresh” button in the report, we see the new rows appeared with PredictSales populated.

